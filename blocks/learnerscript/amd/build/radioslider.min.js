define(["jquery","block_learnerscript/report"],function(l,e){return RadiosToSlider={init:function(e,i){this.KNOB_WIDTH=10,this.KNOB_MARGIN=42,this.LEVEL_MARGIN=this.KNOB_MARGIN+10,this.LABEL_WIDTH=34,this.LEVEL_WIDTH=10,this.bearer=e,this.options=i,this.currentLevel=0,this.value=null;var t=[];e.each(function(){i=l.extend({},this.defaults,i),RadiosToSlider.activate(),t.push({bearer:this.bearer,setDisable:RadiosToSlider.setDisable.bind(RadiosToSlider),setEnable:RadiosToSlider.setEnable.bind(RadiosToSlider),getValue:RadiosToSlider.getValue.bind(RadiosToSlider)})})},activate:function(){this.numOptions=this.bearer.find("input[type=radio]").length,this.reset(),this.fitContainer(),this.addBaseStyle(),this.addLevels(),this.addBar(),this.setSlider(),this.addInteraction(),this.setDisabled();var e=this;l(window).on("resize orientationChanged",function(){e.reset(),e.fitContainer(),e.addBaseStyle(),e.addLevels(),e.setSlider(),e.addInteraction(),e.setDisabled()})},reset:function(){var e=this.bearer.find("label"),i=this.bearer.find(".slider-level");e.each(function(){var e=l(this);e.removeClass("slider-label"),e.css("left",0)}),i.each(function(){l(this).remove()}),this.bearer.css("width","auto")},fitContainer:function(){this.options.fitContainer&&(this.KNOB_MARGIN=(this.bearer.width()-this.KNOB_WIDTH)/(this.numOptions-1)-this.KNOB_WIDTH,this.LEVEL_MARGIN=this.KNOB_MARGIN+10)},addBaseStyle:function(){var t=0,a=this,e=this.numOptions*this.LEVEL_WIDTH+(this.numOptions-1)*this.LEVEL_MARGIN;this.bearer.find("input[type=radio]").hide(),this.bearer.addClass("radios-to-slider "+this.options.size),this.bearer.css("width",e+"px"),this.bearer.find("label").each(function(){var e=l(this),i=a.KNOB_WIDTH/2-a.LABEL_WIDTH/2+t*a.LEVEL_MARGIN+t*a.LEVEL_WIDTH;e.addClass("slider-label"),e.css("left",i+"px"),t++})},addLevels:function(){var t=this.bearer,a=0,s=this;t.find("input[type=radio]").each(function(){var e=l(this);t.append("<ins class='slider-level' data-radio='"+e.attr("id")+"' data-value="+e.val()+"></ins>")}),t.find(".slider-level").each(function(){var e=l(this),i=t.css("padding-left").replace("px","")-0+a*s.LEVEL_MARGIN+a*s.LEVEL_WIDTH;e.css("left",i+"px"),a++})},addBar:function(){this.bearer.append("<ins class='slider-bar'><span class='slider-knob'></span></ins>")},setSlider:function(){var i,e=this.bearer.find("input[type=radio]"),t=this.bearer.find(".slider-level"),a=this.bearer.find(".slider-label"),s=1,r=this;e.each(function(){var e=l(this),i=r.bearer.find(".slider-bar");e.attr("id");if(e.prop("checked")){var t=s*r.KNOB_WIDTH+(s-1)*r.KNOB_MARGIN+10*(s-1);i.css("display","block"),i.width(t+"px"),r.currentLevel=s}r.options.animation&&i.addClass("transition-enabled"),s++}),i=0,t.each(function(){i++;var e=l(this);i<r.currentLevel?(e.show(),e.addClass("slider-lower-level")):i==r.currentLevel?e.hide():(e.show(),e.removeClass("slider-lower-level"))}),i=0,a.each(function(){i++;var e=l(this);i==r.currentLevel?e.addClass("slider-label-active"):e.removeClass("slider-label-active")})},addInteraction:function(){var r=this,n=r.bearer,d=n.find(".slider-level:not(.disabled)"),o=n.find("input[type=radio]:not(:disabled)");d.on("click",function(e){e.stopImmediatePropagation();var i=l(this),t=i.attr("data-value"),a=i.attr("data-radio"),s=n.find("#"+a);require(["block_learnerscript/smartfilter"],function(e){e.DurationFilter(t,r.options.reportdashboard)}),s.prop("checked",!0),r.options.onSelect&&r.options.onSelect(s,[d,o]),r.value=t,n.attr("data-value",t),r.setSlider(),n.trigger("radiochange")}),o.on("change",function(e){e.stopImmediatePropagation();var i=l(this),t=i.attr("value"),a=i.attr("data-radio"),s=n.find("#"+a);require(["block_learnerscript/smartfilter"],function(e){e.DurationFilter(t,r.options.reportdashboard)}),s.prop("checked",!0),r.options.onChange&&r.options.onChange(s,[d,o]),r.value=t,n.attr("data-value",t),r.setSlider(),n.trigger("radiochange")})},setDisabled:function(e,i){this.options.isDisable&&this.setDisable()},setDisable:function(e){this.options.isDisable=!0;var i=this.bearer,t=this.bearer.find(".slider-level"),a=this.bearer.find("input[type=radio]");l.merge(t,a).each(function(){var e=l(this);e.prop("disabled",!0).addClass("disabled"),e.off("click change")}),"function"==typeof e&&e(t,a),i.trigger("radiodisabled")},setEnable:function(e){this.options.isDisable=!1;var i=this,t=i.bearer,a=this.bearer.find(".slider-level"),s=this.bearer.find("input[type=radio]");l.merge(a,s).each(function(){l(this).prop("disabled",!1).removeClass("disabled"),i.addInteraction()}),"function"==typeof e&&e(a,s),t.trigger("radiodenabled")},getValue:function(){return this.value}}});